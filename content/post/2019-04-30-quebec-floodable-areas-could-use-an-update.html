---
title: Quebec floodable areas could use an update...
author: Simon
date: '2019-04-30'
slug: quebec-floodable
categories:
  - R
  - flood
  - opendata
tags: []
keywords:
  - tech
thumbnailImage: "/post/2019-04-30-quebec-floodable-areas-could-use-an-update_files/Screenshot_20190430_101705.png" 
thumbnailImagePosition: left
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/pymjs/pym.v1.js"></script>
<script src="/rmarkdown-libs/widgetframe-binding/widgetframe.js"></script>


<p>UPDATE 2020: addr.country, n’existe plus dans les buildings de osm data. aussi il faut faire st_collection_extract(type=“POLYGON”) car mes intersections ont commencé à retourner des geometry collection
This morning I heard an annoucement from the provincial government telling me that preparing for floods is my responsibility, that I should check if my house is in a floodable area and that I should visit quebec.ca/inondations for more information.</p>
<p>We currently have multiple major flooding events in the city of Gatineau. I used open data about buildings (package osmdata), <a href="https://www.donneesquebec.ca/recherche/fr/dataset/vgat-zones-inondables-norme-v1">floodable area</a> and <a href="https://www.donneesquebec.ca/recherche/fr/dataset/cartographie-des-inondations-printemps-2019">flooded areas</a> to figure out what percentage of flooded homes actually are in a floodable area. Turns out that more than half of the flooded homes were outside the floodable areas and had no reason to prepare.</p>
<p>This is a dangerous situation and definitely needs fixing.</p>
<p>As usual, the code is available on github. Code snippets I will be coming back to involve the chain were I dropped the worst polygons using st_is_valid(reason=TRUE), fixed the fixable polygons using st_make_valid(), then casted the result usint st_cast(“MULTIPOLYGON”) to make everything digestable by leaflet. Another useful snippet is names(st_geometry(all_builds )) = NULL , because the data generated by osmdata_sf has named geometry, which leaflet doesnt like.</p>
<div id="htmlwidget-1" style="width:95%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"/post/2019-04-30-quebec-floodable-areas-could-use-an-update_files/figure-html//widgets/widget_map.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
